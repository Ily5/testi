from selenium.webdriver.support.ui import Select


class PageHelper:

    def __init__(self, app):
        self.app = app

    def check_navigate_elements(self):
        wd = self.app.wd
        wd.find_element_by_link_text("Logic").click()
        wd.find_element_by_link_text("Entities").click()
        wd.find_element_by_link_text("Records").click()
        wd.find_element_by_link_text("Prompts").click()
        wd.find_element_by_link_text("Data uploading").click()
        wd.find_element_by_link_text("Call Logs").click()
        wd.find_element_by_link_text("Analytics").click()
        wd.find_element_by_link_text("Accounts").click()

    def open_projects_menu(self):
        wd = self.app.wd
        wd.find_element_by_id("a_project").click()

    def add(self, project):
        wd = self.app.wd
        self.open_projects_menu()
        wd.find_element_by_link_text("Create New Agent").click()
        wd.find_element_by_id("name_add").send_keys(project.name)
        wd.find_element_by_id("description_add").send_keys(project.description)
        wd.find_element_by_name("not_before").send_keys(project.not_before)
        wd.find_element_by_name("not_after").send_keys(project.not_after)
        wd.find_element_by_name("delay").send_keys(project.delay)
        wd.find_element_by_id("count_add").send_keys(project.count)
        wd.find_element_by_id("channel_add").send_keys(project.channel)
        wd.find_element_by_id("flag_add").send_keys(project.flag)
        wd.find_element_by_id("api_url_add").send_keys(project.api_url)
        wd.find_element_by_id("start_unit_add").send_keys(project.start_unit)
        wd.find_element_by_id("log_verbose").click()
        wd.find_element_by_id("record_path").send_keys(project.record_path)
        wd.find_element_by_id("caller_id").send_keys(project.caller_id)
        wd.find_element_by_id("before_call_unit").send_keys(project.before_call_unit)
        wd.find_element_by_id("after_call_unit").send_keys(project.after_call_unit)
        wd.find_element_by_id("routing_channel_limit").send_keys(project.routing_channel_limit)
        wd.find_element_by_id("total_channel_limit").send_keys(project.total_channel_limit)
        wd.find_element_by_id("company_id").click()
        Select(wd.find_element_by_id("company_id")).select_by_visible_text("Neuro.net")
        wd.find_element_by_xpath("//option[@value='1']").click()
        wd.find_element_by_id("pool_id").click()
        Select(wd.find_element_by_id("pool_id")).select_by_visible_text("test_pool")
        wd.find_element_by_xpath("(//option[@value='1'])[3]").click()
        wd.find_element_by_id("language").click()
        Select(wd.find_element_by_id("language")).select_by_visible_text("Russian (Russia)-ru-RU")
        wd.find_element_by_xpath("//option[@value='ru-RU']").click()
        wd.find_element_by_id("asr").click()
        Select(wd.find_element_by_id("asr")).select_by_visible_text("yandex")
        wd.find_element_by_xpath("//option[@value='yandex']").click()
        wd.find_element_by_id("tts").send_keys(project.tts)
        wd.find_element_by_id("btn_add_project_save").click()

    def edit(self, project):
        wd = self.app.wd
        self.open_projects_menu()
        wd.find_element_by_link_text("Settings").click()
        wd.find_element_by_id("name_edit").clear()
        wd.find_element_by_id("name_edit").send_keys(project.name)
        wd.find_element_by_id("description_edit").clear()
        wd.find_element_by_id("description_edit").send_keys(project.description)
        wd.find_element_by_id("not_before_edit").send_keys(project.not_before)
        wd.find_element_by_id("not_after_edit").send_keys(project.not_after)
        wd.find_element_by_id("delay_edit").send_keys(project.delay)
        wd.find_element_by_id("count_edit").send_keys(project.count)
        wd.find_element_by_id("channel_edit").clear()
        wd.find_element_by_id("channel_edit").send_keys(project.channel)
        wd.find_element_by_id("flag_edit").clear()
        wd.find_element_by_id("flag_edit").send_keys(project.flag)
        wd.find_element_by_id("api_url_edit").clear()
        wd.find_element_by_id("api_url_edit").send_keys(project.api_url)
        wd.find_element_by_id("start_unit_edit").clear()
        wd.find_element_by_id("start_unit_edit").send_keys(project.start_unit)
        wd.find_element_by_id("log_verbose").click()
        wd.find_element_by_id("record_path").clear()
        wd.find_element_by_id("record_path").send_keys(project.record_path)
        wd.find_element_by_id("caller_id").clear()
        wd.find_element_by_id("caller_id").send_keys(project.caller_id)
        wd.find_element_by_id("before_call_unit").clear()
        wd.find_element_by_id("before_call_unit").send_keys(project.before_call_unit)
        wd.find_element_by_id("after_call_unit").clear()
        wd.find_element_by_id("after_call_unit").send_keys(project.after_call_unit)
        wd.find_element_by_id("routing_channel_limit").clear()
        wd.find_element_by_id("routing_channel_limit").send_keys(project.routing_channel_limit)
        wd.find_element_by_id("total_channel_limit").clear()
        wd.find_element_by_id("total_channel_limit").send_keys(project.total_channel_limit)
        wd.find_element_by_id("company_id").click()
        Select(wd.find_element_by_id("company_id")).select_by_visible_text("Neuro.net")
        wd.find_element_by_xpath("//option[@value='1']").click()
        wd.find_element_by_id("pool_id").click()
        Select(wd.find_element_by_id("pool_id")).select_by_visible_text("test_pool")
        wd.find_element_by_xpath("(//option[@value='1'])[3]").click()
        wd.find_element_by_id("language").click()
        Select(wd.find_element_by_id("language")).select_by_visible_text("Russian (Russia)")
        wd.find_element_by_xpath("//option[@value='ru-RU']").click()
        wd.find_element_by_id("asr").click()
        Select(wd.find_element_by_id("asr")).select_by_visible_text("yandex")
        wd.find_element_by_xpath("//option[@value='yandex']").click()
        wd.find_element_by_id("tts").clear()
        wd.find_element_by_id("tts").send_keys(project.tts)
        wd.find_element_by_id("btn_edit_project_save").click()
